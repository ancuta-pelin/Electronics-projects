Version 4
SHEET 1 2356 680
WIRE -16 0 -224 0
WIRE 160 0 -16 0
WIRE 288 0 160 0
WIRE 544 0 368 0
WIRE -224 64 -224 0
WIRE -16 64 -16 0
WIRE 160 64 160 0
WIRE -224 208 -224 144
WIRE -16 208 -16 128
WIRE -16 208 -224 208
WIRE 160 208 160 144
WIRE 160 208 -16 208
WIRE 384 208 160 208
WIRE 544 208 384 208
WIRE 384 240 384 208
WIRE 624 240 384 240
WIRE 1984 240 1728 240
WIRE -64 272 -128 272
WIRE 624 272 624 240
WIRE -64 320 -64 272
WIRE -336 352 -336 304
WIRE 224 352 224 320
WIRE 1728 352 1728 240
WIRE 1984 352 1984 240
WIRE 2000 352 1984 352
WIRE 2016 352 2000 352
WIRE 2000 368 1968 368
WIRE 2016 368 2000 368
WIRE 2096 400 2080 400
WIRE 2192 400 2096 400
WIRE 2192 416 2192 400
WIRE -64 448 -64 400
WIRE 224 464 224 432
WIRE -336 480 -336 432
WIRE 1728 480 1728 432
WIRE 1968 480 1968 368
WIRE 2192 544 2192 496
FLAG 624 272 0
FLAG -64 448 0
FLAG -128 272 illu
FLAG 544 0 v+
FLAG 544 208 v-
FLAG -336 480 0
FLAG -336 304 illu
FLAG 224 464 0
FLAG 224 320 v+
FLAG 1728 480 0
FLAG 1968 480 0
FLAG 2192 544 0
FLAG 2000 352 1
FLAG 2000 368 2
FLAG 2096 400 3
SYMBOL res 144 48 R0
SYMATTR InstName R1
SYMATTR Value {Rsh}
SYMBOL res 384 -16 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value {Rs}
SYMBOL res -80 304 R0
SYMATTR InstName R3
SYMATTR Value 100Meg
SYMBOL voltage -336 336 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 1000
SYMBOL current 224 352 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName I1
SYMATTR Value PULSE(0 1 0 1 1)
SYMBOL diode -32 64 R0
SYMATTR InstName D1
SYMATTR Value SolarDiode
SYMBOL bi -224 144 R180
WINDOW 0 24 80 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName B1
SYMATTR Value I=v(illu)/1000*Iph
SYMBOL testcell1 2048 384 R0
SYMATTR InstName U1
SYMBOL current 1728 352 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName I2
SYMATTR Value PULSE(0 1 0 1 1)
SYMBOL voltage 2192 400 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 1000
TEXT 488 -168 Left 2 !.param rs=1
TEXT 488 -136 Left 2 !.param rsh=10k
TEXT 488 -104 Left 2 !.param iph=1
TEXT 488 -72 Left 2 !.param io=1e-6
TEXT 488 -48 Left 2 !.param a_n=10
TEXT -424 -128 Left 2 !.tran 1
TEXT -416 -88 Left 2 ;v() returns the value of the voltage at that specific point in the circuit.
TEXT -424 -168 Left 2 !.model solardiode d(is=io n=a_n tref=temp)
TEXT 1712 -224 Left 2 !*\n.subckt testcell1 1 2 3 \nxul 1 2 3 PVbasic rs=1 rsh=10k iph=1 io=1e-6 a_n=10\n.ends\n*\n \n.subckt PVbasic v+ v- illu\nB1 v- N001 I=v(illu)/1000*Iph\nD1 N001 v- SolarDiode\nR1 N001 v- {Rsh}\nR2 v+ N001 {Rs}\nR3 illu 0 100Meg\n.model solardiode d(is=io n=a_n tref=temp)\n.ends
